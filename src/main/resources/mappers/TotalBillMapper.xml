<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.reimbursement.dao.TotalBillDao">

	<resultMap id="totalBillMap"
		type="cn.reimbursement.pojo.TotalBill">
		<id property="totalBillId" column="total_bill_id" />
		<result property="totalBillName" column="total_bill_name" />
		<result property="companyName" column="company_name" />
		<result property="totalBillMoney" column="total_bill_money" />
		<result property="totalBillRegistDate"
			column="total_bill_regist_date" />
		<result property="totalBillRegistPerson"
			column="total_bill_regist_person" />
		<result property="totalBillRemark" column="total_bill_remark" />
	</resultMap>
	<resultMap id="billMap" type="cn.reimbursement.pojo.Bill">
		<id property="billId" column="bill_id" />
		<result property="billAttribute" column="bill_attribute" />
		<result property="billCompany" column="bill_company" />
		<result property="billType" column="bill_type" />
		<result property="billReimbursementDep"
			column="bill_reimbursement_dep" />
		<result property="billSubject" column="bill_subject" />
		<result property="billBelongCompany"
			column="bill_belong_company" />
		<result property="billReimbursementPerson"
			column="bill_reimbursement_person" />
		<result property="billSummary" column="bill_summary" />
		<result property="billAmount" column="bill_amount" />
		<result property="billContractStatusName"
			column="bill_contract_status_name" />
		<result property="billInvoiceStatusName"
			column="bill_invoice_status_name" />
		<result property="billInvoiceAmount"
			column="bill_invoice_amount" />
		<result property="billReimbursementPersonConfirm"
			column="bill_reimbursement_person_confirm" />
		<result property="billChargePerson" column="bill_charge_person" />
		<result property="billRegistrantPerson"
			column="bill_registrant_person" />
		<result property="billRegistrantDate"
			column="bill_registrant_date" />
		<result property="billProduceDate" column="bill_produce_date" />
		<result property="billIsEnd" column="bill_is_end" />
		<result property="billEndDate" column="bill_end_date" />
	</resultMap>
	<!--sql – 可被其他语句引用的可重用语句块 -->
	<sql id="totalBillColums">
		total_bill_id,total_bill_name,company_name,total_bill_money,total_bill_regist_date,total_bill_regist_person,total_bill_remark
	</sql>
	<sql id="billColums">
		bill_id,bill_attribute,bill_company,bill_type,bill_reimbursement_dep,bill_subject,bill_belong_company,bill_reimbursement_person,bill_summary,bill_amount,bill_contract_status_name,bill_invoice_status_name,bill_invoice_amount,bill_reimbursement_person_confirm,
		bill_charge_person,bill_registrant_person,bill_registrant_date,bill_produce_date,bill_is_end,bill_end_date
	</sql>

	<select id="selectBillByTotalBillId" resultMap="billMap">
		SELECT
		<include refid="billColums" />
		FROM bill WHERE bill_id IN (SELECT bill_id FROM total_bill_detail
		WHERE total_bill_id=#{totalBillId})
		limit #{start},#{limit}
	</select>
	<select id="selectBillCountByTotalBillId" resultType="int">
		SELECT
		COUNT(*)
		FROM bill WHERE bill_id IN (SELECT bill_id
		FROM
		total_bill_detail
		WHERE total_bill_id=#{totalBillId})
	</select>

</mapper>